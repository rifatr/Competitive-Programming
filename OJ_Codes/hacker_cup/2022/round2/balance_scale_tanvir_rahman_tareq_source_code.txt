#include<bits/stdc++.h>

#define ll long long

using namespace std;

#define nl '\n'
#define MD 1000000007LL

ll fct[10000100];

ll bigmod(ll b, ll p, ll md)
{
	if(p==0) return 1;
	ll x=bigmod(b, p/2, md);
	x=(x*x)%md;
	if(p%2)
	{
		x=(x*b)%md;
	}
	return x;
}

ll ncr(ll n, ll r)
{
	ll rt=fct[n];
	rt=(rt*bigmod(fct[r], MD-2, MD))%MD;
	rt=(rt*bigmod(fct[n-r], MD-2, MD))%MD;
	return rt;
}
ll npr(ll n, ll r)
{
	ll rt=fct[n];
	rt=(rt*bigmod(fct[n-r], MD-2, MD))%MD;
	return rt;
}


void solve()
{
	ll n, k;
	cin>>n>>k;
	ll boro=0, suto=0, soman=0;
	ll ase=0;
	ll w=0;
	cin>>ase>>w;
	for(int i=2;i<=n;i++)
	{
		ll a, b;
		cin>>a>>b;
		if(b==w) soman+=a;
		else if(b<w) suto+=a;
		else if(b>w) boro+=a;
	}
	ll ans=0;
	for(int i=0;i<=k;i++)
	{
		if(ase-1+soman<i) break;
		if(suto<k-i) continue;
		// if(k-i+1<i+1) continue;
		ll rt=ase;
		rt=(rt*npr(ase-1+soman, i))%MD;
		rt=(rt*npr(suto, k-i))%MD;
		ll gap=k-i+1;
		ll bosabo=i+1;
		rt=(rt*ncr(gap+bosabo-1, bosabo))%MD;
		// cout<<i<<" "<<rt<<endl;
		ans=(ans+rt)%MD;
	}
	ll tt=(boro+suto+soman+ase);
	ans=(ans*bigmod(npr(tt, k+1), MD-2, MD))%MD;
	cout<<ans<<nl;
}


int main()
{
	// freopen("balance_scale_input.txt", "r", stdin);
	ios_base::sync_with_stdio(false);
	cin.tie(NULL);
	fct[0]=1;
	for(ll i=1;i<=10000000;i++)
	{
		fct[i]=(fct[i-1]*i)%MD;
	}
	int t=1;
	cin>>t;
	for(int i=1;i<=t;i++)
	{
		cout<<"Case #"<<i<<": ";
		solve();
	}

	return 0;
}